webpackJsonp([4],{AQf5:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("Xxa5"),i=a.n(e),r=a("exGp"),n=a.n(r),o=a("gRE1"),c=a.n(o),_=a("Dd8w"),d=a.n(_),u=a("NYxO"),h=a("ra3+"),l=a("Uoa1"),p=a("44dg"),v=a("i84Q"),f={data:function(){return{geohash:"",shopId:null,showLoading:!0,checkoutData:null,shopCart:null,showPayWay:!1,payWayId:1,showAlert:!1,alertText:null,imgBaseUrl:"//elm.cangdu.org/img/"}},created:function(){this.geohash=this.$route.query.geohash,this.shopId=this.$route.query.shopId,this.INIT_BUYCART(),this.SAVE_SHOPID(this.shopId),this.shopCart=this.cartList[this.shopId]},mounted:function(){this.geohash&&(this.initData(),this.SAVE_GEOHASH(this.geohash)),!this.userInfo||this.userInfo.user_id},components:{headTop:h.a,alertTip:l.a,loading:p.a},computed:d()({},Object(u.d)(["cartList","remarkText","inputText","invoice","choosedAddress","userInfo"]),{remarklist:function(){var t="";return this.remarkText&&c()(this.remarkText).forEach(function(s){t+=s[1]+"，"}),this.inputText?t+this.inputText:t.substr(0,t.lastIndexOf("，"))}}),methods:d()({},Object(u.c)(["INIT_BUYCART","SAVE_GEOHASH","CHOOSE_ADDRESS","NEED_VALIDATION","SAVE_CART_ID_SIG","SAVE_ORDER_PARAM","ORDER_SUCCESS","SAVE_SHOPID"]),{initData:function(){var t=this;return n()(i.a.mark(function s(){var a;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=[],c()(t.shopCart).forEach(function(t){c()(t).forEach(function(t){c()(t).forEach(function(t){a.push({attrs:[],extra:{},id:t.id,name:t.name,packing_fee:t.packing_fee,price:t.price,quantity:t.num,sku_id:t.sku_id,specs:[t.specs],stock:t.stock})})})}),s.next=4,Object(v.d)(t.geohash,[a],t.shopId);case 4:t.checkoutData=s.sent,t.SAVE_CART_ID_SIG({cart_id:t.checkoutData.cart.id,sig:t.checkoutData.sig}),t.initAddress(),t.showLoading=!1;case 8:case"end":return s.stop()}},s,t)}))()},initAddress:function(){var t=this;return n()(i.a.mark(function s(){var a;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!t.userInfo||!t.userInfo.user_id){s.next=5;break}return s.next=3,Object(v.n)(t.userInfo.user_id);case 3:(a=s.sent)instanceof Array&&a.length&&t.CHOOSE_ADDRESS({address:a[0],index:0});case 5:case"end":return s.stop()}},s,t)}))()},showPayWayFun:function(){this.showPayWay=!this.showPayWay},choosePayWay:function(t,s){t&&(this.showPayWay=!this.showPayWay,this.payWayId=s)},iconColor:function(t){switch(t){case"公司":return"#4cd964";case"学校":return"#3190e8"}},confrimOrder:function(){var t=this;return n()(i.a.mark(function s(){var a;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.userInfo&&t.userInfo.user_id){s.next=6;break}return t.showAlert=!0,t.alertText="请登录",s.abrupt("return");case 6:if(t.choosedAddress){s.next=10;break}return t.showAlert=!0,t.alertText="请添加一个收货地址",s.abrupt("return");case 10:return t.SAVE_ORDER_PARAM({user_id:t.userInfo.user_id,cart_id:t.checkoutData.cart.id,address_id:t.choosedAddress.id,description:t.remarklist,entities:t.checkoutData.cart.groups,geohash:t.geohash,sig:t.checkoutData.sig}),s.next=13,Object(v.B)(t.userInfo.user_id,t.checkoutData.cart.id,t.choosedAddress.id,t.remarklist,t.checkoutData.cart.groups,t.geohash,t.checkoutData.sig);case 13:(a=s.sent).need_validation?(t.NEED_VALIDATION(a),t.$router.push("/confirmOrder/userValidation")):(t.ORDER_SUCCESS(a),t.$router.push("/confirmOrder/payment"));case 15:case"end":return s.stop()}},s,t)}))()}}),watch:{userInfo:function(t){t&&t.user_id&&this.initAddress()}}},m={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"confirmOrderContainer"},[t.showLoading?t._e():a("section",[a("head-top",{attrs:{"head-title":"确认订单",goBack:"true","signin-up":"confirmOrder"}}),t._v(" "),a("router-link",{staticClass:"address_container",attrs:{to:{path:"/confirmOrder/chooseAddress",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[a("div",{staticClass:"address_empty_left"},[a("span",{staticClass:"distance-icon"}),t._v(" "),t.choosedAddress?a("div",{staticClass:"address_detail_container"},[a("header",[a("span",[t._v(t._s(t.choosedAddress.name))]),t._v(" "),a("span",[t._v(t._s(1==t.choosedAddress.sex?"先生":"女士"))]),t._v(" "),a("span",[t._v(t._s(t.choosedAddress.phone))])]),t._v(" "),a("div",{staticClass:"address_detail"},[t.choosedAddress.tag?a("span",{style:{backgroundColor:t.iconColor(t.choosedAddress.tag)}},[t._v(t._s(t.choosedAddress.tag))]):t._e(),t._v(" "),a("p",[t._v(t._s(t.choosedAddress.address_detail))])])]):a("div",{staticClass:"add_address"},[t._v("请添加一个收货地址")])]),t._v(" "),a("span",{staticClass:"arrow-right"})]),t._v(" "),a("section",{staticClass:"delivery_model container_style"},[a("p",{staticClass:"deliver_text"},[t._v("送达时间")]),t._v(" "),a("section",{staticClass:"deliver_time"},[a("p",[t._v("尽快送达 | 预计 "+t._s(t.checkoutData.delivery_reach_time))]),t._v(" "),t.checkoutData.cart.is_deliver_by_fengniao?a("p",[t._v("蜂鸟专送")]):t._e()])]),t._v(" "),a("section",{staticClass:"pay_way container_style"},[a("header",{staticClass:"header_style"},[a("span",[t._v("支付方式")]),t._v(" "),a("div",{staticClass:"more_type",on:{click:t.showPayWayFun}},[a("span",[t._v("在线支付")]),t._v(" "),a("span",{staticClass:"arrow-right"})])]),t._v(" "),t._m(0)]),t._v(" "),a("section",{staticClass:"food_list"},[t.checkoutData.cart.restaurant_info?a("header",[a("img",{attrs:{src:t.imgBaseUrl+t.checkoutData.cart.restaurant_info.image_path,alt:"shop-img"}}),t._v(" "),a("span",[t._v(t._s(t.checkoutData.cart.restaurant_info.name))])]):t._e(),t._v(" "),t.checkoutData.cart.groups?a("ul",{staticClass:"food_list_ul"},t._l(t.checkoutData.cart.groups[0],function(s){return a("li",{key:s.id,staticClass:"food_item_style"},[a("p",{staticClass:"food_name ellipsis"},[t._v(t._s(s.name))]),t._v(" "),a("div",{staticClass:"num_price"},[a("span",[t._v("x "+t._s(s.quantity))]),t._v(" "),a("span",[t._v("¥"+t._s(s.price))])])])}),0):t._e(),t._v(" "),t.checkoutData.cart.extra?a("div",{staticClass:"food_item_style"},[a("p",{staticClass:"food_name ellipsis"},[t._v(t._s(t.checkoutData.cart.extra[0].name))]),t._v(" "),a("div",{staticClass:"num_price"},[a("span"),t._v(" "),a("span",[t._v("¥ "+t._s(t.checkoutData.cart.extra[0].price))])])]):t._e(),t._v(" "),a("div",{staticClass:"food_item_style"},[a("p",{staticClass:"food_name ellipsis"},[t._v("配送费")]),t._v(" "),a("div",{staticClass:"num_price"},[a("span"),t._v(" "),a("span",[t._v("¥ "+t._s(t.checkoutData.cart.deliver_amount||0))])])]),t._v(" "),a("div",{staticClass:"food_item_style total_price"},[a("p",{staticClass:"food_name ellipsis"},[t._v("订单 ¥"+t._s(t.checkoutData.cart.total))]),t._v(" "),a("div",{staticClass:"num_price"},[a("span",[t._v("待支付 ¥"+t._s(t.checkoutData.cart.total))])])])]),t._v(" "),a("section",{staticClass:"pay_way container_style"},[a("router-link",{staticClass:"header_style",attrs:{to:{path:"/confirmOrder/remark",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[a("span",[t._v("订单备注")]),t._v(" "),a("div",{staticClass:"more_type"},[a("span",{staticClass:"ellipsis"},[t._v(t._s(t.remarkText||t.inputText?t.remarklist:"口味、偏好等"))]),t._v(" "),a("span",{staticClass:"arrow-right"})])]),t._v(" "),a("router-link",{staticClass:"hongbo pay-footer",class:{support_is_available:t.checkoutData.invoice.is_available},attrs:{to:t.checkoutData.invoice.is_available?"/confirmOrder/invoice":""}},[a("span",[t._v("发票抬头")]),t._v(" "),a("span",{staticClass:"more_type"},[t._v("\n          "+t._s(t.checkoutData.invoice.status_text)+"\n          "),a("span",{staticClass:"arrow-right"})])])],1),t._v(" "),a("section",{staticClass:"confrim_order"},[a("p",[t._v("待支付 ¥"+t._s(t.checkoutData.cart.total))]),t._v(" "),a("p",{on:{click:t.confrimOrder}},[t._v("确认下单")])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.showPayWay?a("div",{staticClass:"cover",on:{click:t.showPayWayFun}}):t._e()]),t._v(" "),a("transition",{attrs:{name:"slid_up"}},[t.showPayWay?a("div",{staticClass:"choose_type_Container"},[a("header",[t._v("支付方式")]),t._v(" "),a("ul",t._l(t.checkoutData.payments,function(s){return a("li",{key:s.id,class:{choose:t.payWayId==s.id}},[a("span",[t._v(t._s(s.name)),s.is_online_payment?t._e():a("span",[t._v(t._s(s.description))])]),t._v(" "),a("span",{staticClass:"address_empty_right",on:{click:function(a){t.choosePayWay(s.is_online_payment,s.id)}}},[t._v("√")])])}),0)]):t._e()])],1),t._v(" "),t.showLoading?a("loading"):t._e(),t._v(" "),t.showAlert?a("alert-tip",{attrs:{alertText:t.alertText},on:{closeTip:function(s){t.showAlert=!1}}}):t._e(),t._v(" "),a("transition",{attrs:{name:"router-slid",mode:"out-in"}},[a("router-view")],1)],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("section",{staticClass:"hongbo"},[s("span",[this._v("红包")]),this._v(" "),s("span",[this._v("暂时只在饿了么 APP 中支持")])])}]};var y=a("VU/8")(f,m,!1,function(t){a("UGSK")},"data-v-7261c34c",null);s.default=y.exports},TmV0:function(t,s,a){a("fZOM"),t.exports=a("FeBl").Object.values},UGSK:function(t,s){},fZOM:function(t,s,a){var e=a("kM2E"),i=a("mbce")(!1);e(e.S,"Object",{values:function(t){return i(t)}})},gRE1:function(t,s,a){t.exports={default:a("TmV0"),__esModule:!0}},mbce:function(t,s,a){var e=a("lktj"),i=a("TcQ7"),r=a("NpIQ").f;t.exports=function(t){return function(s){for(var a,n=i(s),o=e(n),c=o.length,_=0,d=[];c>_;)r.call(n,a=o[_++])&&d.push(t?[a,n[a]]:n[a]);return d}}}});
//# sourceMappingURL=4.e24d1ad227a26a8b34c4.js.map